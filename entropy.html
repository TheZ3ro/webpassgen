<!DOCTYPE html>
<html lang='en'>
  <head>
    <link rel='shortcut icon' href='favicon.ico'>
    <link rel='stylesheet' href='assets/style.css'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0' />
    <meta name='color-scheme' content='dark light'>
    <meta http-equiv='Content-Type' content='text/html; charset=utf-8' />
    <title>Passphrase and Password Generator</title>
  </head>
  <body>
    <div id='container'>
      <div id='header'>
        <h1>Mouse Entropy</h1>
        <ul id='navigation'>
          <li><a href='index.html'>Passwords</a></li>
          <li><a href='entropy.html'>Add Entropy</a></li>
          <li><a href='bookmarklets.html'>Bookmarklets</a></li>
          <li><a href='#' onclick='toggleTheme(); loadPasses();' id='theme_switcher' title='Change theme'>ðŸŒ’</a></li>
        </ul>
      </div>
      <p>This is a <strong>true random number generator</strong> using your mouse/finger movement as a source of entropy. Move your mouse/finger across the noise below to collect true random bits. Inspired by <a href='https://keepass.info'>KeePass</a>.</p>
      <canvas id='randogram' height='400' width='400'></canvas>
      <p class='collected'>Collected: 
        <span class='collected' id='entropyResult2'>0</span> items
        (<span class='collected' id='entropyResult1'>0</span> bits)
      </p>
      <h2>FAQ</h2>
      <p>
        <ul>
          <li><strong>Do I need it?</strong> Most likely not. Seriously. Your passwords are already secure even if you don't use this tool.</li>
          <li><strong>Why then?</strong> Paranoiaâ€”you suspect the browser CSPRNG is compromised or not sufficiently seeded.</li>
          <li><strong>What is an "item"?</strong> It's 16 bits that can be used for a passphrase word or password character.</li>
          <li><strong>How much do I need?</strong> Depends. Most passphrases are 5-10 words, and most passwords are 11-20 characters.</li>
          <li><strong>Then what?</strong> Go back to the password generator, check "Mix entropy?", then the purple "Generate" button.</li>
          <li><strong>What happened?</strong> The entropy was mixed with the browser CSPRNG to produce a true random password.</li>
        </ul>
      </p>
      <h2>Technical</h2>
      <p>
        <ol>
          <li>The noise above is generated with the browser's CSPRNG.</li>
          <li>When the mouse is moved, the bit at the xy-coordinate is collected.</li>
          <li>When two bits are collected, they are whitened using <a href='https://en.wikipedia.org/wiki/Hardware_random_number_generator#Software_whitening'>John von Neumann's debiaser</a>.</li>
          <li>16 whitened bits are stored in an array as 1 item.</li>
          <li>During password generation, each 16-bit item is mixed with the browser CSPRNG using XOR.</li>
          <li>Each 16-bit item is then discarded.</li>
        </ol>
      </p>
    </div>
    <div id="footer" class="clear">
      <p>Never trust online password generators, including this one.<br/>
         For better security, use the <a href="bookmarklets.html">bookmarklets</a>, or my <a href="https://github.com/atoponce/nodepassgen">command-line tool</a>.<br/>
         For best security, use the generator that ships with your password manager.</p>
      <p><strong>For demonstration purposes only. It is not logging passwords.</strong></p>
      <p>
        <a href="https://github.com/atoponce/webpassgen"><img alt="Github logo" title="Get the source code" src="assets/github.png" /></a>
        <a href="https://github.com/atoponce/webpassgen/releases/latest"><img alt="Download icon" title="Download latest release" src="assets/download.png" /></a>
        <a href="https://twitter.com/AaronToponce"><img alt="Twitter logo" title="Meet the author" src="assets/twitter.png" /></a>
      </p>
      <p id='version'>Version: development</p>
    </div>
    <script src='js/main.js'></script>
    <script src='js/randogram.js'></script>
    <script>
      window.onload = function () {
        initTheme()
      }
    </script>
  </body>
</html>
